# GerminaR: data analysis with code 

Analysis for the germination experiment can follow a routine. The functions will de explain according to the data set included in the GerminaR package ("*prosopis*"). 

1. Install and load the GerminaR package. Load the "*prosopis*" dataset on your session. In case of using another dataset, you can load your own data and proceed according to the following script:

```{r, echo=TRUE}
# Install packages and dependencies

library(GerminaR)
library(tidyverse)

# load data

fb <- prosopis %>% 
   dplyr::mutate(across(c(nacl, temp, rep), as.factor))

# Prosopis data set

fb %>% 
   web_table(caption = "Prosopis dataset loaded")
```

2. Calculate the germination indices and perform the ANOVA and the mean comparison tests. The user can generate the graphs, expressing their results, which can be either of bars or lines graphics.

```{r, echo=TRUE}

# germination analysis (ten variables)

gsm <- ger_summary(SeedN = "seeds"
                   , evalName = "D"
                   , data = fb
                   )

# Prosopis data set processed

gsm %>% 
   web_table(caption = "Function ger_summary performe ten germination indices")

```

## Punctual analysis of germination

### Germination percentage

```{r, echo=TRUE, fig.cap="Germination  experiment with *Prosopis juliflor* under different osmotic potentials and temperatures. Bar graph with germination percentage in a factorial analisys"}

## Germination Percentage (GRP)

# analysis of variance

av <- aov(formula = GRP ~ nacl*temp + rep, data = gsm)

# mean comparison test

mc_grp <- ger_testcomp(aov = av
                       , comp = c("temp", "nacl")
                       , type = "snk"
                       )

# data result

mc_grp %>% 
   web_table(caption = "Germination percentage mean comparision")

# bar graphics for germination percentage

grp <- fplot(data = mc_grp
             , type = "bar"
             , x = "temp"
             , y = "mean"
             , z = "nacl"
             , lmt = c(0,120)
             , brk = 10
             , ylab = "Germination ('%')"
             , xlab = "Temperature (ºC)"
             , lgl = "NaCl (MPa)"
             , lgd = "top"
             , erb = T
             , color = F
             , font = 1.8
             )

grp

```

### Mean germination time

```{r, echo=TRUE, fig.cap="Germination  experiment with *Prosopis juliflor* under different osmotic potentials and temperatures. Bar graph for mean germination time in a factorial analisys."}

## Mean Germination Time (MGT)

# analysis of variance

av <- aov(formula = MGT ~ nacl*temp + rep, data = gsm)

# mean comparison test

mc_mgt <- ger_testcomp(aov = av
                       , comp = c("temp", "nacl")
                       , type = "snk")

# data result

mc_mgt %>% 
   web_table(caption = "Mean germination time comparison")

# bar graphics for mean germination time

mgt <- fplot(data = mc_mgt
             , type = "bar" 
             , x = "temp"
             , y = "mean"
             , z = "nacl"
             , lmt = c(0,9)
             , brk = 1
             , ylab = "Mean germination time (days)"
             , xlab = "Temperature (ºC)"
             , lgl = "NaCl (MPa)"
             , lgd = "top"
             , sig = "sg"
             , erb = T
             , color = F
             , font = 1.2
             )

mgt
```

> You can add at each plot different arguments as the standard error, significance of the mean test, color, labels and limits. The resulted graphics are performed for publications and allows to insert math expression in the titles.

## Cumulative analysis of germination

The cumulative analysis of the germination allows to observe the evolution of the germination process, being able to be expressed as the percentage of germination or with the relative germination. 

### In time analysis for NaCl 

```{r, echo=TRUE, fig.cap="Germination  experiment with *Prosopis juliflor* under different osmotic potentials and temperatures. Line graph from cumulative germination under different osmotic potentials."}

# data frame with percentage or relative germination in time by NaCl

git <- ger_intime(Factor = "nacl"
                  , SeedN = "seeds"
                  , evalName = "D"
                  , method = "percentage"
                  , data = fb
                  )

# graphic germination in time by NaCl

nacl <- fplot(data = git
              , type = "line"
              , x = "evaluation"
              , y = "mean"
              , z = "nacl"
              , lmt = c(0, 110)
              , brk = 10
              , ylab = "Germination ('%')"
              , xlab = "Day"
              , lgl = "NaCl (MPa)"
              , lgd = "top"
              , color = F
              , erb = T
              )
nacl

```

### In time analysis for temperature 

```{r, echo=TRUE, fig.cap="Germination  experiment with *Prosopis juliflor* under different osmotic potentials and temperatures. Line graph from cumulative germination under different temperatures."}

# data frame with percentage or relative germination in time by temperature

git <- ger_intime(Factor = "temp"
                  , SeedN = "seeds"
                  , evalName = "D"
                  , method = "percentage"
                  , data = fb) 

# graphic germination in time by temperature

temp <- fplot(data = git
              , type = "line"
              , x = "evaluation"
              , y = "mean"
              , z = "temp"
              , lmt = c(0, 110)
              , brk = 10
              , ylab = "Germination ('%')"
              , xlab = "Day"
              , lgl = "Temperature ('°C')"
              , lgd = "top"
              , color = F
              , font = 1.2
              ) 
temp

```


### In time using ggplot2

GerminaR transform the x axis in discrete values. If you need manipulate the x labels you can work directly with [ggplot2](https://ggplot2.tidyverse.org/). I will implement in the next versions of GerminaR the possibility to manipulate the x axis with `fplot()` function. Also, you can see [Bar and line graphs (ggplot2)](http://www.cookbook-r.com/Graphs/Bar_and_line_graphs_(ggplot2)/)

```{r, echo=TRUE}

git <- ger_intime(Factor = "temp"
                  , SeedN = "seeds"
                  , evalName = "D"
                  , method = "percentage"
                  , data = fb
                  ) 

ggplot <- git %>% 
   ggplot(aes(x = evaluation
              , y =  mean
              , group = temp
              , shape = temp
              )) +
   geom_line() +
   geom_point() +
   scale_x_continuous(name = "Days"
                      , minor_breaks = 2
                      , limits = c(0, 11)
                      ) +
   scale_y_continuous(name = "Germination") +
   scale_shape_discrete("Temperature") +
   theme_bw()

ggplot

```


